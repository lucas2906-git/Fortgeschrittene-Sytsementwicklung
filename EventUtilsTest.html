<!--Gruppe 1-->

<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Event Planner Test</title>
<script src="JS/EventAdder.js"></script>
<script src="JS/EventSortandSearch.js"></script>
</head>
<body>

<h1>Event Planner Test</h1>
<p>Öffne die Konsole (F12) für die Ergebnisse.</p>

<!-- Ul mit vorhandenen Events -->
<ul id="events">
    <li>
        <strong class="title">Rock am Ring</strong><br>
        <strong>Datum: </strong><time class="date">07.06.2025</time><br>
        Festival
    </li>
    <li>
        <strong class="title">Oktoberfest</strong><br>
        <strong>Datum: </strong><time class="date">21.09.2024</time><br>
        Bier
    </li>
</ul>

<!-- Sortieren + Suche -->
<select name="sort" id="sort" onchange="sortEvents()">
    <option value="dateAscending">Datum aufsteigend</option>
    <option value="dateDescending">Datum absteigend</option>
    <option value="titleAscending">Titel A-Z</option>
    <option value="titleDescending">Titel Z-A</option>
</select>

<input type="search" id="searchEvent" placeholder="Suche..." oninput="searchEvent()">

<script>
console.log('=== ROBUSTER EVENT PLANNER TEST START ===');

// Hilfsfunktion, um Test sicher auszuführen
function safeTest(testName, fn) {
    try {
        fn();
    } catch (e) {
        console.log(`${testName}: FEHLER (${e.message})`);
    }
}

// Event hinzufügen simulieren
safeTest('Test 1: Event hinzufügen', () => {
    const eventsUl = document.getElementById('events');
    if (!eventsUl) throw new Error('#events fehlt');

    const newEvent = {
        title: 'Wacken Open Air',
        date: '15.02.2025',
        description: 'Metal Festival'
    };

    eventsUl.innerHTML += `
        <li>
            <strong class="title">${newEvent.title}</strong><br>
            <strong>Datum: </strong><time class="date">${newEvent.date}</time><br>
            ${newEvent.description}
        </li>
    `;

    const lis = eventsUl.querySelectorAll('li');
    if (lis.length === 3) console.log('Test 1: OK');
    else throw new Error('Event nicht hinzugefügt');
});

// Sortieren Datum aufsteigend
safeTest('Test 2: Sortieren Datum aufsteigend', () => {
    if (typeof sortEvents !== 'function') throw new Error('sortEvents() fehlt');

    const sortSelect = document.getElementById('sort');
    if (!sortSelect) throw new Error('#sort fehlt');

    sortSelect.value = 'dateAscending';
    sortEvents();

    const firstTitle = document.querySelector('#events li:first-child .title');
    if (!firstTitle) throw new Error('erstes li fehlt');
    if (firstTitle.innerText === 'Oktoberfest') console.log('Test 2: OK');
    else throw new Error('Sortierung falsch');
});

// Sortieren Datum absteigend
safeTest('Test 3: Sortieren Datum absteigend', () => {
    if (typeof sortEvents !== 'function') throw new Error('sortEvents() fehlt');

    document.getElementById('sort').value = 'dateDescending';
    sortEvents();

    const firstTitle = document.querySelector('#events li:first-child .title');
    if (firstTitle && firstTitle.innerText === 'Rock am Ring') console.log('Test 3: OK');
    else throw new Error('Sortierung falsch');
});

// Suche testen
safeTest('Test 4: Suche nach "rock"', () => {
    if (typeof searchEvent !== 'function') throw new Error('searchEvent() fehlt');

    const searchInput = document.getElementById('searchEvent');
    if (!searchInput) throw new Error('#searchEvent fehlt');

    searchInput.value = 'rock';
    searchEvent();

    const visible = Array.from(document.querySelectorAll('#events li'))
        .filter(li => li.style.display !== 'none');
    if (visible.length === 1 && visible[0].querySelector('.title').innerText === 'Rock am Ring') {
        console.log('Test 4: OK');
    } else throw new Error('Suche falsch');
});

// Suche ohne Treffer
safeTest('Test 5: Suche nach "xyz"', () => {
    const searchInput = document.getElementById('searchEvent');
    searchInput.value = 'xyz';
    searchEvent();

    const visible = Array.from(document.querySelectorAll('#events li'))
        .filter(li => li.style.display !== 'none');
    if (visible.length === 0) console.log('Test 5: OK');
    else throw new Error('Suche falsch');
});

console.log('TEST ENDE');
</script>

</body>
</html>
